# 05_実行・運用ガイド

**対応プログラム機能**: メイン実行・運用管理機能  
**最終更新**: 2025年08月14日

---

## 🚀 基本実行方法

### システム起動
```bash
# ディレクトリ移動
cd /Users/satoumasamitsu/Desktop/osigoto/ブログ自動化/

# システム実行
python3 マフィンブログ統合システム.py
```

### 起動時の自動実行内容
```yaml
initialization:
  - "テンプレート読み込み（サービス紹介型・ノウハウ解説型）"
  - "WordPress API接続テスト"
  - "品質基準設定読み込み"

automatic_tasks:
  - "自動ファイル整理（7日以上の古いファイル削除）"
  - "統合管理システムとの同期実行"
  - "システムヘルスチェック"

output:
  - "利用可能機能の表示"
  - "システム動作確認結果"
```

---

## 🎯 機能別実行方法

### 1. 記事作成（テンプレート準拠）
```python
from マフィンブログ統合システム import マフィンブログ統合システム

# システム初期化
system = マフィンブログ統合システム()

# 記事作成実行
result = system.create_article_from_template(
    topic="二刀流読書",
    keywords=["Audible", "読書効果", "集中力向上"],
    source_material="NotebookLM要約データ"
)

# 結果確認
print(f"作成結果: {result['success']}")
print(f"品質スコア: {result['quality_score']}/100")
print(f"保存先: {result['saved_path']}")
```

### 2. WordPress投稿・管理
```python
# 下書き投稿
post_result = system.create_wordpress_post(
    title="記事タイトル",
    content="記事内容",
    category="Audible",
    tags=["読書効果", "Audible", "集中力"],
    meta_description="メタディスクリプション",
    status="draft"  # または "publish"
)

# 記事バックアップ
backup_result = system.backup_post(post_id=123)

# 記事削除（保護記事チェック付き）
delete_result = system.delete_post(post_id=123)
```

### 3. 品質チェック実行
```python
# 記事品質チェック
quality_result = system._perform_comprehensive_quality_check({
    "title": "記事タイトル",
    "content": "記事内容",
    "keywords": ["キーワード1", "キーワード2"]
})

print(f"品質スコア: {quality_result['score']}/100")
print(f"合格判定: {quality_result['passed']}")
print(f"改善点: {quality_result['issues']}")
```

### 4. 統合管理システム同期
```python
# 手動同期実行
sync_result = system.sync_with_integration_system()

print(f"同期結果: {sync_result['updated_files']}")
print(f"エラー: {sync_result['errors']}")
```

### 5. サイトヘルスチェック
```python
# 総合ヘルスチェック
health_result = system.comprehensive_site_health_check()

print(f"全体ステータス: {health_result['overall_status']}")
print(f"WordPress接続: {health_result['wordpress_connection']}")
print(f"テンプレート状態: {health_result['templates_loaded']}")
```

---

## ⚙️ 設定・カスタマイズ

### 環境変数設定
```bash
# WordPress API設定
export WORDPRESS_SITE_URL="https://muffin-blog.com"
export WORDPRESS_USERNAME="muffin1203"
export WORDPRESS_PASSWORD="TMLy Z4Wi RhPu oVLm 0lcO gZdi"

# その他設定
export BACKUP_RETENTION_DAYS=30
export CLEANUP_RETENTION_DAYS=7
```

### 品質基準カスタマイズ
```python
# 品質基準の変更例
system.quality_standards["minimum_word_count"] = 3000  # 最低文字数変更
system.quality_standards["faq_count_min"] = 7  # FAQ最小数変更
system.quality_standards["quality_lessons"]["minimum_score"] = 85  # 合格点変更
```

### テンプレート切り替え
```python
# 記事タイプ別テンプレート選択
if "始め方" in keywords or "おすすめ" in keywords:
    template_type = "service_introduction"
    template_content = system.service_template['content']
elif "効果" in keywords or "方法" in keywords:
    template_type = "howto_explanation"
    template_content = system.howto_template['content']
```

---

## 🔧 トラブルシューティング

### よくある問題と解決法

#### 1. WordPress API接続エラー
```yaml
症状: "❌ WordPress API接続失敗: 401"
原因: "認証情報の誤り"
解決法:
  - "環境変数の設定確認"
  - "アプリケーションパスワードの再生成"
  - "サイトURLの確認（最後の'/'なし）"
```

#### 2. テンプレート読み込み失敗
```yaml
症状: "❌ サービス紹介型テンプレート読み込み失敗"
原因: "ファイルパスの誤りまたはファイル不存在"
解決法:
  - "ファイルパスの確認"
  - "ファイル存在確認"
  - "権限設定確認"
```

#### 3. 品質スコア不合格
```yaml
症状: "品質チェック不合格: スコア65点"
原因: "文字数不足、FAQ不足、禁止表現使用"
解決法:
  - "文字数確認（2,000文字以上）"
  - "FAQ数確認（5個以上）"
  - "禁止表現チェック"
```

#### 4. 同期システムエラー
```yaml
症状: "❌ 同期エラー: ファイル更新失敗"
原因: "権限不足またはファイルロック"
解決法:
  - "ファイル権限確認"
  - "他のプロセスでファイル使用中でないか確認"
  - "ディスク容量確認"
```

### エラーコード対応表
```yaml
E001: "WordPress API接続失敗"
  - 認証情報確認
  - ネットワーク接続確認

E002: "テンプレート読み込み失敗"
  - ファイルパス確認
  - ファイル権限確認

E003: "品質チェック不合格"
  - 品質基準確認
  - 記事内容修正

E004: "同期システムエラー"
  - ファイル権限確認
  - ディスク容量確認
```

---

## 📊 ログ・監視

### ログファイル場所
```bash
# システムログ
/Users/satoumasamitsu/Desktop/osigoto/ブログ自動化/logs/

# バックアップファイル
/Users/satoumasamitsu/Desktop/osigoto/ブログ自動化/バックアップ・復元/バックアップファイル/

# 日報・学習ログ
/Users/satoumasamitsu/Desktop/osigoto/統合管理システム/日報・ログ/
```

### 監視項目
```yaml
daily_checks:
  - "WordPress API接続状態"
  - "テンプレートファイル存在確認"
  - "バックアップファイル作成状況"
  - "同期ファイル更新状況"

weekly_checks:
  - "品質スコア推移"
  - "記事投稿数"
  - "エラー発生頻度"
  - "ディスク使用量"
```

---

## 🔄 定期メンテナンス

### 日次メンテナンス（自動実行）
```yaml
automatic_daily:
  - "古いファイル整理（7日以上）"
  - "バックアップ作成"
  - "システムヘルスチェック"
  - "統合管理システム同期"
```

### 週次メンテナンス（手動推奨）
```yaml
manual_weekly:
  - "品質基準見直し"
  - "テンプレート更新確認"
  - "エラーログ確認"
  - "パフォーマンス確認"
```

### 月次メンテナンス（手動推奨）
```yaml
manual_monthly:
  - "古いバックアップ削除（30日以上）"
  - "WordPress API設定確認"
  - "システム全体の動作確認"
  - "仕様書更新確認"
```

---

## 🚀 パフォーマンス最適化

### 実行速度改善
```python
# 並列処理による高速化例
import concurrent.futures

def parallel_quality_check(articles):
    """複数記事の並列品質チェック"""
    with concurrent.futures.ThreadPoolExecutor(max_workers=3) as executor:
        futures = [executor.submit(system._perform_comprehensive_quality_check, article) 
                  for article in articles]
        results = [future.result() for future in futures]
    return results
```

### メモリ使用量最適化
```python
# 大量データ処理時のメモリ最適化
def process_large_content(content):
    """大容量コンテンツの効率的処理"""
    # チャンク分割処理
    chunk_size = 1000
    for i in range(0, len(content), chunk_size):
        chunk = content[i:i+chunk_size]
        yield process_chunk(chunk)
```

---

## 🔐 セキュリティ・バックアップ

### セキュリティ対策
```yaml
security_measures:
  - "API認証情報の環境変数化"
  - "HTTPS通信の強制"
  - "タイムアウト設定"
  - "入力値サニタイズ"
```

### バックアップ戦略
```yaml
backup_strategy:
  daily: "記事データ自動バックアップ"
  weekly: "システム設定バックアップ"
  monthly: "完全システムバックアップ"
  retention: "30日間保存"
```

---

**プログラム参照**: `マフィンブログ統合システム.py:2400-2500行目`  
**関連仕様書**: [付録/A_API設定・環境変数.md](./付録/A_API設定・環境変数.md), [付録/C_エラーコード一覧.md](./付録/C_エラーコード一覧.md)